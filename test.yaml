

powerprotect_protection_rule:
- name: hourly
  protection_policy_name: hourly
  asset_type: kubernetes
  label: "backup-schedule=hourly"


- name: daily
  protection_policy_name: daily
  asset_type: kubernetes
  label: "backup-schedule=daily"



get prtoection rule by name

Does it exist?

If not create protection rule

if it does  compare existing fields vs playbook expected fields

if matches do nothing

if not match update existing body with fields then update

get all rules

if a rule exists in PPDM but not in playbook

if fact delete_rule=true

delete rule

if fact delete_rule=false

leave it
